After conducting a security audit within the Stratos DC, the Nautilus security team discovered misconfigured permissions on critical files. To address this, corrective actions are being taken by the production support team. Specifically, the file named /etc/hosts on Nautilus App 1 server requires adjustments to its Access Control Lists (ACLs) as follows: 1. The file's user owner and group owner should be set to root. 2. Others should possess read only permissions on the file. 3. User mark must not have any permissions on the file. 4. User jerome should be granted read only permission on the file.

Fix ACL Permissions on /etc/hosts

Server: Nautilus App 1 (stapp01)
Role Perspective: Senior Linux System Administrator â€“ Project Nautilus

1ï¸âƒ£ Task Understanding
ğŸ”¹ What is the task?

We must correct file ownership, standard permissions, and ACL permissions on the critical system file:

/etc/hosts


Specifically:

User owner â†’ root

Group owner â†’ root

Others â†’ read-only

User mark â†’ no permissions

User jerome â†’ read-only permission

This involves both traditional Linux permissions and Access Control Lists (ACLs).

ğŸ”¹ Why is this required in real enterprises?

/etc/hosts affects hostname resolution

Incorrect permissions can:

Allow unauthorized modification

Break application networking

Introduce security vulnerabilities

Security audits often flag ACL misconfigurations

Compliance standards (ISO, SOC2, CIS) require:

Least privilege

Explicit access control

Audit-friendly permission models

ğŸ”¹ Which server does this apply to and why?

Server: Nautilus App 1 (stapp01)

Reason:

App servers resolve DB, LB, and internal services

/etc/hosts is frequently used in enterprise environments for internal name resolution overrides

2ï¸âƒ£ Prerequisites & Assumptions
ğŸ” Required Access

root user or sudo privileges

/etc/hosts is a protected system file

ACL changes require elevated permissions

ğŸ“ Required Files & Services

File must exist:

/etc/hosts


ACL support must be enabled (default on modern RHEL/CentOS/Ubuntu)

ğŸ” Important Checks Before Starting
ls -l /etc/hosts
getfacl /etc/hosts


Purpose:

Confirm current ownership

Detect existing ACLs

Avoid accidental permission lockout

3ï¸âƒ£ Exact Commands (Step-by-Step)
ğŸŸ¢ Step 1: Switch to root (recommended)
sudo -i


Why:
Avoids partial privilege failures and ensures consistent audit logs.

ğŸŸ¢ Step 2: Set user & group owner to root
chown root:root /etc/hosts


Explanation:

chown â†’ change ownership

root:root â†’ user = root, group = root

/etc/hosts â†’ target file

Why best practice:
System configuration files must always be owned by root to prevent privilege escalation.

ğŸŸ¢ Step 3: Set standard permissions (Others = read-only)
chmod 644 /etc/hosts


Permission breakdown:

6 â†’ owner â†’ read + write
4 â†’ group â†’ read
4 â†’ others â†’ read


Why:

Prevents accidental edits

Still allows system processes to read the file

ğŸŸ¢ Step 4: Remove all permissions for user mark
setfacl -m u:mark:--- /etc/hosts


Explanation:

setfacl â†’ manage ACLs

-m â†’ modify ACL

u:mark:--- â†’ no read/write/execute

Why ACL instead of chmod?
Because chmod affects all users, while ACL targets specific users.

ğŸŸ¢ Step 5: Grant read-only permission to user jerome
setfacl -m u:jerome:r-- /etc/hosts


Explanation:

Explicit read access

No write or execute permission

Why:
Allows controlled visibility without modification risk.

4ï¸âƒ£ Verification & Validation
ğŸ” Check ownership & standard permissions
ls -l /etc/hosts


Expected output:

-rw-r--r--+ 1 root root ... /etc/hosts


ğŸ‘‰ + indicates ACLs are present (important!)

ğŸ” Check ACL entries
getfacl /etc/hosts


Expected ACL output:

# file: etc/hosts
# owner: root
# group: root
user::rw-
user:mark:---
user:jerome:r--
group::r--
mask::r--
other::r--


âœ” Confirms:

mark â†’ no access

jerome â†’ read-only

others â†’ read-only

ğŸ” Confirm no errors
setfacl --test -m u:jerome:r-- /etc/hosts


If no output â†’ no errors.

5ï¸âƒ£ Errors & Troubleshooting
âŒ Error: setfacl: command not found

Fix:

yum install acl -y
# or
apt install acl -y

âŒ Error: Operation not permitted

Cause: Not root
Fix:

sudo -i

âŒ ACL overwritten by chmod

Reason:
chmod changes mask implicitly
Fix:
Reapply ACL after chmod (correct order matters)

6ï¸âƒ£ Security & Best Practices
ğŸ” Security Implications

Prevents unauthorized file tampering

Ensures traceable, auditable access

Protects hostname resolution integrity

âœ… Why this approach is recommended

Combines traditional permissions + ACL

Least privilege model

Enterprise-compliant

Easily auditable

ğŸ”„ Alternatives

SELinux file contexts (advanced)

Immutable flag (chattr +i) â€“ not recommended here due to operational flexibility needs

7ï¸âƒ£ Final Task Summary

Action: Corrected ownership, permissions, and ACLs

Server: Nautilus App 1 (stapp01)

File: /etc/hosts

Result: Secure, audit-compliant access control applied

Status: âœ… Successful
